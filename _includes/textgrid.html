{%- comment -%}
  Check whether TextGrid services are affacted by an `item` of `itemtyp` outage or announcement and render the output.
{%- endcomment -%}


{% comment %} Load TG services {% endcomment %}
{% assign tglab = site.services | where:"id", '/services/tglab' | first %}
{% assign tgrep = site.services | where:"id", '/services/tgrep' | first %}


<!-- {{ tglab_affected }} -->
<!-- {{ tgrep_affected }} -->

{%- capture tglab_affected %}{% include check_service.html outage=include.item service=tglab %}{% endcapture %}
{%- capture tgrep_affected %}{% include check_service.html outage=include.item service=tgrep %}{% endcapture %}

{% comment %} Process outage data {% endcomment %}
<div class="
{%- if tgrep_affected contains "yepp" -%} repstatus {% endif -%}
{%- if tglab_affected contains "yepp" -%} status {% endif -%}
 {{ include.itemtype }}">
  <p lang="en">
    <b>{{ include.item.title }}</b><br/>
    {% include timestamp.html %}
    <br/>
    {{ include.item.description | markdownify | remove: '<p>' | remove: '</p>' }}<br/>
  </p>
</div>

<!-- {{ tglab_affected }} -->
<!-- {{ tgrep_affected }} -->
